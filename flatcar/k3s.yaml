variant: flatcar
version: 1.0.0

systemd:
  units:
    - name: k3s-install.service
      enabled: true
      contents: |
        [Unit]
        Description=K3s install
        Wants=network-online.target
        After=network-online.target
        ConditionFirstBoot=yes
        [Service]
        Type=oneshot
        Restart=on-failure
        RemainAfterExit=true
        ExecStart=/usr/bin/bash -c 'curl -sfL https://get.k3s.io | sh -'
        [Install]
        WantedBy=multi-user.target

passwd:
  users:
  - name: core
    ssh_authorized_keys:
    - "ssh-rsa AAAA..."
